---
title: "Resolución Problemas"
author: "Marcos Palomino Rodríguez"
date: "2024-10-14"
output:
  pdf_document: default
  html_document: default
---
###Enunciado Problema 1:
Una empresa de desarrollo de videojuegos está considerando lanzar un nuevo juego al mercado. El juego puede enfocarse en cuatro géneros distintos: un RPG de mundo abierto, un shooter multijugador, un juego de estrategia por turnos y un juego deportivo. Los beneficios esperados, en millones de euros en el año siguiente al lanzamiento, dependiendo de las condiciones del mercado, son las siguientes:

```{r}
crea.tablaX = function(vector_matporfilas,numalternativas=3,numestados=4) {

  X = matrix(vector_matporfilas,nrow=numalternativas,ncol=numestados,byrow=TRUE)
  colnames(X) = paste('e',1:numestados,sep='');
  rownames(X) = paste('d',1:numalternativas,sep='');
  return(X);

}
X = matrix(c(35,25,26,24,32,29,28,28,31,32,30,25,33,30,24,29),nrow=4,ncol=4,byrow=TRUE)
colnames(X)=c('e1','e2','e3','e4')
rownames(X)=c('RPG','Shooter','Estrategia','Deportivo')
X
```

Por otro lado, esta sería la tabla que representa los costes, en millones de euros, esperados en el próximo año:

```{r}
X = matrix(c(11,6,6,10,7,8,6,6,5,10,7,8),nrow=4,ncol=3,byrow=TRUE)
colnames(X)=c('e1','e2','e3')
rownames(X)=c('RPG','Shooter','Estrategia','Deportivo')
X
```

¿Cuál sería la opción que le recomendaría a la empresa?
```{r}
source("teoriadecision_funciones_incertidumbre.R")

```

```{r }
tb01a=crea.tablaX(c(35,25,26,24,32,29,28,28,31,32,30,25,33,30,24,29),numalternativas = 4, numestados = 4)
tb01a
```

- Comenzamos con el criterio de Wald:
  
  ```{r}
criterio.Wald(tb01a, favorable=TRUE)
```

La mejor alternativa para este criterio de Wald es la "d2" (Shooter), con un valor óptimo de 28.

- Criterio optimista:
  
  ```{r}
criterio.Optimista(tb01a,T)
```
La mejor alternativa para este criterio optimista es la "d1" (RPG), con un valor óptimo de 35.

- Criterio de Hurwicz:
  
  ```{r}
criterio.Hurwicz(tb01a,alfa=0.4,T)
```
Para este criterio la mejor alternativa es de nuevo "d2" (Shooter), con un valor óptimo de 29,6.


```{r}
criterio.Hurwicz.General(tb01a)
```

```{r}
dibuja.criterio.Hurwicz(tb01a)
```
- Criterio Savage:
  
  ```{r}
criterio.Savage(tb01a,T)
```
La mejor alternativa paa este criterio de Savage es la "d2" (Shooter), siendo el valor óptimo 3. 

- Criterio de LaPlace:
  
  ```{r}
criterio.Laplace(tb01a,T)
```
La mejor alternativa para este criterio es la "d3" (Estrategia), con un valor óptimo de 29,5.

- Criterio de Punto Ideal:
  
  ```{r}
criterio.PuntoIdeal(tb01a,T)
```
La mejor alternativa para este criterio de Punto Ideal es la "d2" (Shooter), con un valor óptimo de 4,795832.

- Todos los criterios:
  
  ```{r}
criterio.Todos(tb01a,0.4,T)
```

Ahora, vamos con la tabla de costos.

```{r}
tb01b=crea.tablaX(c(10,6,6,9,7,8,7,8,7,9,7,8), numalternativas = 4, numestados = 3)

tb01b
```

- Comenzamos con el criterio de Wald:
  
  ```{r}
criterio.Wald(tb01b, favorable=FALSE)
```

La mejor alternativa para este criterio de Wald es la "d3" (Estrategia), con un valor óptimo de 8.

- Criterio optimista:
  
  ```{r}
criterio.Optimista(tb01b,F)
```
La mejor alternativa para este criterio optimista es la "d1" (RPG), con un valor óptimo de 6.

- Criterio de Hurwicz:
  
  ```{r}
criterio.Hurwicz(tb01b,alfa=0.4,F)
```
Para este criterio la mejor alternativa es de nuevo "d3" (Estrategia), con un valor óptimo de 7,6.


```{r}
criterio.Hurwicz.General(tb01b)
```

```{r}
dibuja.criterio.Hurwicz(tb01b)
```
- Criterio Savage:
  
  ```{r}
criterio.Savage(tb01b,F)
```
La mejor alternativa paa este criterio de Savage es la "d2" (Shooter), "d3" (Estrategia) y "d4" (Deportivo), siendo el valor óptimo 2. 

- Criterio de LaPlace:
  
  ```{r}
criterio.Laplace(tb01b,F)
```
La mejor alternativa para este criterio es la "d1" (RPG) y "d3" (Estrategia), con un valor óptimo de 7,3333.

- Criterio de Punto Ideal:
  
  ```{r}
criterio.PuntoIdeal(tb01b,F)
```
La mejor alternativa para este criterio de Punto Ideal es la "d3" (Estrategia), con un valor óptimo de 2,236068.

- Todos los criterios:
  
  ```{r}
criterio.Todos(tb01b,0.4,F)
```

Después de realizar todos los criterios, vemos como claramente el videojuego que más rentable es, es el Shooter Multijugador ("d2"), ganando en la mayoría de criterios. Por otro lado, podemos ver que en cuanto a costes, parece que la que menos coste necesita es el juego de Estrategia ("d3"), aunque sin tanta diferencia ya que en dos de los criterios en los que gana, comparte esta posición con otros juegos. Por lo que, si yo fuese el encargado de recomendar a la empresa la realización de un juego u otro, le recomendaría el Shooter Multijugador ("d2").


###Enunciado problema 2:
Una familia está considerando cambiar su sistema de calefacción para el invierno. Tienen cuatro opciones: calefacción eléctrica, calefacción a gas, caldera de leña y bomba de calor. Dependiendo de las condiciones climáticas (invierno suave, invierno moderado, invierno frío o invierno muy frío
), los costos esperados en euros para todo el invierno son los siguientes:

```{r}
crea.tablaX = function(vector_matporfilas,numalternativas=3,numestados=4) {

  X = matrix(vector_matporfilas,nrow=numalternativas,ncol=numestados,byrow=TRUE)
  colnames(X) = paste('e',1:numestados,sep='');
  rownames(X) = paste('d',1:numalternativas,sep='');
  return(X);

}
X = matrix(c(400,420,450,520,300,320,370,480,220,320,400,450,250,300,380,500),nrow=4,ncol=4,byrow=TRUE)
colnames(X)=c('e1','e2','e3','e4')
rownames(X)=c('Electrica','Gas','Caldera de leña','Bomba de Calor')
X
```

La familia desea tomar la mejor decisión basándose solo en los costos esperados. ¿Por cuál sistema de calefacción deberían apostar?

Para saber cuál sistema es más rentable, realizaremos todos los criterios sobre nuestros datos:

```{r}
tb02=crea.tablaX(c(400,420,450,520,300,320,370,480,220,320,400,450,250,300,380,500), numalternativas = 4, numestados = 4)

tb02
```
```{r}
criterio.Todos(tb02,0.4,F)
```
Pues, como podemos ver en los resultados, la solución más económica para esta familia es la "d3", correspondiente a la Caldera de Leña, ya que es la más destacada en todos los criterios. 
